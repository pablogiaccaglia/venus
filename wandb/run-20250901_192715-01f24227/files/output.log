LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type     | Params | Mode
---------------------------------------------
0 | model   | Unet     | 32.5 M | train
1 | loss_fn | DiceLoss | 0      | train
---------------------------------------------
32.5 M    Trainable params
0         Non-trainable params
32.5 M    Total params
130.059   Total estimated model params size (MB)
224       Modules in train mode
0         Modules in eval mode
c:\Users\pabli\AppData\Local\pypoetry\Cache\virtualenvs\venus-nCPuPPcI-py3.9\lib\site-packages\lightning\pytorch\trainer\connectors\data_connector.py:433: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=23` in the `DataLoader` to improve performance.
c:\Users\pabli\Desktop\venus\breast_segmentation\metrics\evaluation.py:386: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  dice_score = torch.tensor(compute_dice_score_single(y_true_flat, y_pred_flat, class_id, exclude_empty)).float()
c:\Users\pabli\AppData\Local\pypoetry\Cache\virtualenvs\venus-nCPuPPcI-py3.9\lib\site-packages\lightning\pytorch\trainer\connectors\data_connector.py:433: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=23` in the `DataLoader` to improve performance.

Detected KeyboardInterrupt, attempting graceful shutdown ...
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
c:\Users\pabli\AppData\Local\pypoetry\Cache\virtualenvs\venus-nCPuPPcI-py3.9\lib\site-packages\lightning\pytorch\trainer\connectors\data_connector.py:433: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=23` in the `DataLoader` to improve performance.
{   'test_acc_per_dataset_background': 0.38510560989379883,
    'test_acc_per_dataset_mass': 0.005189253482967615,
    'test_acc_per_image_background': 0.38525286316871643,
    'test_acc_per_image_mass': 0.2353905886411667,
    'test_accuracy': 0.39465829730033875,
    'test_dice_per_dataset_background': 0.4978881776332855,
    'test_dice_per_dataset_background_no_empty': 0.4978881776332855,
    'test_dice_per_dataset_mass': 0.010214114561676979,
    'test_dice_per_dataset_mass_no_empty': 0.010214114561676979,
    'test_dice_per_image_background': 0.40340766310691833,
    'test_dice_per_image_background_no_empty': 0.40340766310691833,
    'test_dice_per_image_mass': 0.273477703332901,
    'test_dice_per_image_mass_no_empty': 0.273477703332901,
    'test_iou_per_dataset_background': 0.38510560989379883,
    'test_iou_per_dataset_background_no_empty': 0.38510560989379883,
    'test_iou_per_dataset_mass': 0.005189253482967615,
    'test_iou_per_dataset_mass_no_empty': 0.005189253482967615,
    'test_iou_per_image_background': 0.38525286316871643,
    'test_iou_per_image_background_no_empty': 0.38525286316871643,
    'test_iou_per_image_mass': 0.2353905886411667,
    'test_iou_per_image_mass_no_empty': 0.2353905886411667,
    'test_loss': 0.7427574396133423,
    'test_mean_dice_per_dataset': 0.3458317518234253,
    'test_mean_dice_per_dataset_no_empty': 0.3458317518234253,
    'test_mean_dice_per_image': 0.3458317816257477,
    'test_mean_dice_per_image_no_empty': 0.3458317816257477,
    'test_mean_iou_per_dataset': 0.3174149990081787,
    'test_mean_iou_per_dataset_no_empty': 0.3174149990081787,
    'test_mean_iou_per_image': 0.3174149990081787,
    'test_mean_iou_per_image_no_empty': 0.3174149990081787,
    'test_per_dataset_dice': 0.005971589591354132,
    'test_per_dataset_iou': 0.002994736423715949,
    'test_per_image_dice': 0.2799040973186493,
    'test_per_image_iou': 0.2409418821334839,
    'test_precision': 0.6608220934867859,
    'test_recall': 0.643271803855896}
============================================================
FINAL RESULTS SUMMARY - BASELINE MODELS
============================================================

FCN-FFNET: Not trained

Swin-UNETR: Not trained

UNet++: Not trained

SegNet: Not trained

SkinnyNet: Not trained

ResNet-UNet:
  test_per_dataset_dice: 0.0060
  test_per_dataset_iou: 0.0030
  test_mean_dice_per_dataset: 0.3458
  test_mean_iou_per_dataset: 0.3174
  test_accuracy: 0.3947
  test_precision: 0.6608
  test_recall: 0.6433

============================================================
CLEAN BASELINE NOTEBOOK COMPLETED
============================================================
============================================================
FINAL RESULTS SUMMARY - BASELINE MODELS
============================================================

FCN-FFNET: Not trained

Swin-UNETR: Not trained

UNet++: Not trained

SegNet: Not trained

SkinnyNet: Not trained

ResNet-UNet:
  test_loss: 0.7428
  test_per_image_iou: 0.2409
  test_per_dataset_iou: 0.0030
  test_per_image_dice: 0.2799
  test_per_dataset_dice: 0.0060
  test_mean_iou_per_image: 0.3174
  test_mean_iou_per_dataset: 0.3174
  test_mean_iou_per_image_no_empty: 0.3174
  test_mean_iou_per_dataset_no_empty: 0.3174
  test_mean_dice_per_image: 0.3458
  test_mean_dice_per_dataset: 0.3458
  test_mean_dice_per_image_no_empty: 0.3458
  test_mean_dice_per_dataset_no_empty: 0.3458
  test_precision: 0.6608
  test_recall: 0.6433
  test_accuracy: 0.3947
  test_iou_per_image_mass: 0.2354
  test_iou_per_image_background: 0.3853
  test_iou_per_dataset_mass: 0.0052
  test_iou_per_dataset_background: 0.3851
  test_iou_per_image_mass_no_empty: 0.2354
  test_iou_per_image_background_no_empty: 0.3853
  test_iou_per_dataset_mass_no_empty: 0.0052
  test_iou_per_dataset_background_no_empty: 0.3851
  test_dice_per_image_mass: 0.2735
  test_dice_per_image_background: 0.4034
  test_dice_per_dataset_mass: 0.0102
  test_dice_per_dataset_background: 0.4979
  test_dice_per_image_mass_no_empty: 0.2735
  test_dice_per_image_background_no_empty: 0.4034
  test_dice_per_dataset_mass_no_empty: 0.0102
  test_dice_per_dataset_background_no_empty: 0.4979
  test_acc_per_image_mass: 0.2354
  test_acc_per_image_background: 0.3853
  test_acc_per_dataset_mass: 0.0052
  test_acc_per_dataset_background: 0.3851

============================================================
CLEAN BASELINE NOTEBOOK COMPLETED
============================================================
